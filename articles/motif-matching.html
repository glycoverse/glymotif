<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Science Behind Motif Matching â€¢ glymotif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Science Behind Motif Matching">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glycoverse/glymotif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The Science Behind Motif Matching</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/glycoverse/glymotif/blob/main/vignettes/motif-matching.Rmd" class="external-link"><code>vignettes/motif-matching.Rmd</code></a></small>
      <div class="d-none name"><code>motif-matching.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="welcome-to-the-heart-of-glymotif">Welcome to the Heart of <code>glymotif</code> ğŸ”¬<a class="anchor" aria-label="anchor" href="#welcome-to-the-heart-of-glymotif"></a>
</h2>
<p>Ever wondered whatâ€™s happening under the hood when you call
<code><a href="../reference/have_motif.html">have_motif()</a></code> or <code><a href="../reference/count_motif.html">count_motif()</a></code>? Youâ€™re about to
embark on a fascinating journey through the intricate world of glycan
pattern recognition! ğŸš€</p>
<p>In this vignette, weâ€™ll demystify the sophisticated algorithms that
power all <code>glymotif</code> functions. The rules are rooted in the
comprehensive <a href="https://glycomotif.glyomics.org/" class="external-link">GlycoMotif</a>
database, but weâ€™ve tailored them specifically for practical glycan
analysis workflows.</p>
<p><strong>A quick note:</strong> ğŸ“ We use IUPAC-condensed glycan text
representations throughout. If this format looks like hieroglyphics to
you, take a detour to <a href="https://glycoverse.github.io/glyrepr/articles/iupac.html" class="external-link">this
excellent primer</a> first. Trust usâ€”itâ€™s worth it!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glymotif/">glymotif</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-biological-reality-defining-our-terms">The Biological Reality: Defining Our Terms ğŸ§¬<a class="anchor" aria-label="anchor" href="#the-biological-reality-defining-our-terms"></a>
</h2>
<p>Before diving into the technical details, letâ€™s establish some
clarity about what weâ€™re actually matching.</p>
<p>Throughout this vignette, <strong>â€œglycanâ€</strong> refers to a
complete carbohydrate structureâ€”the whole molecular tree, from its
reducing end (often attached to proteins or lipids) to its non-reducing
termini.</p>
<p><strong>â€œMotifâ€</strong>, on the other hand, is any structurally
meaningful pattern within that tree. It could be:</p>
<ul>
<li>A single monosaccharide ğŸ¯</li>
<li>A small oligosaccharide unit ğŸ”—</li>
<li>An entire glycan structure ğŸŒ³</li>
</ul>
<p>Our central question is beautifully simple: <strong>Does the given
glycan contain this particular motif?</strong></p>
<p>Letâ€™s start with a visual example that illustrates this concept:</p>
<p><img src="img/intro_example.png"></p>
<p>Looking at this diagram, we can confidently say â€œthe glycan contains
the motif with exactly 1 occurrence.â€ The presence part is determined by
<code><a href="../reference/have_motif.html">have_motif()</a></code>, while the counting aspect is handled by
<code><a href="../reference/count_motif.html">count_motif()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac(a2-3)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-3)Gal(b1-3)GalNAc(b1-"</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac(a2-3)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Does the glycan have the motif? "</span>, <span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motif</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Does the glycan have the motif? TRUE"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"How many occurrences of the motif are there in the glycan? "</span>, <span class="fu"><a href="../reference/count_motif.html">count_motif</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motif</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "How many occurrences of the motif are there in the glycan? 1"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="why-not-just-use-str_detect">Why Not Just Use <code>str_detect()</code>? ğŸ¤”<a class="anchor" aria-label="anchor" href="#why-not-just-use-str_detect"></a>
</h2>
<p>You might be thinking: â€œThis example looks straightforwardâ€”why not
just use string matching?â€ Great question! ğŸ’­ Letâ€™s test that
hypothesis:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link">fixed</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Indeed, it works for this simple case. But hereâ€™s where the plot
thickensâ€¦ ğŸ­</p>
<p>Real-world glycan analysis is gloriously complex. Consider these
challenging scenarios:</p>
<ul>
<li>
<strong>Complex branching patterns</strong> with multiple attachment
points ğŸŒ¿</li>
<li>
<strong>Ambiguous linkage annotations</strong> where details are
missing or uncertain â“</li>
<li>
<strong>Generic monosaccharide assignments</strong> from mass
spectrometry data ğŸ”</li>
<li>
<strong>Chemical modifications and substituents</strong> that add
layers of complexity âš—ï¸</li>
<li>
<strong>Positional constraints</strong> where context determines
biological meaning ğŸ“</li>
<li>
<strong>Reducing end anomers</strong> that affect molecular
recognition ğŸ”„</li>
</ul>
<p>Writing regular expressions to handle all these nuances? Thatâ€™s a
one-way ticket to debugging hell! ğŸ˜± Thatâ€™s precisely why we need
sophisticated computational tools for this task.</p>
</div>
<div class="section level2">
<h2 id="demystifying-the-complexity-one-rule-at-a-time">Demystifying the Complexity: One Rule at a Time ğŸ§©<a class="anchor" aria-label="anchor" href="#demystifying-the-complexity-one-rule-at-a-time"></a>
</h2>
<p>The <code><a href="../reference/have_motif.html">have_motifs()</a></code> and <code><a href="../reference/count_motif.html">count_motifs()</a></code>
functions return matrices with meaningful row and column names. For
clarity in our demonstrations, letâ€™s create simplified wrapper
functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># You don't have to understand this.</span></span>
<span><span class="va">have_motifs_simple</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="../reference/have_motif.html">have_motifs</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span>, <span class="va">...</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">count_motifs_simple</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="../reference/count_motif.html">count_motifs</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span>, <span class="va">...</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now, letâ€™s explore each matching rule systematically.</p>
<div class="section level3">
<h3 id="rule-1-branching-logic">Rule 1: Branching Logic ğŸŒ³<a class="anchor" aria-label="anchor" href="#rule-1-branching-logic"></a>
</h3>
<p>Branching patterns are actually quite intuitive once you think of
glycans as tree structures. Letâ€™s examine this with a concrete
example:</p>
<p><img src="img/branches_1.png"></p>
<p>Letâ€™s check three distinct motifs, each representing a different
level of structural complexity:</p>
<ol style="list-style-type: decimal">
<li>â€œGal(??-â€ - a single monosaccharide building block</li>
<li>â€œFuc(??-?)GlcNAc(??-â€ - a disaccharide with ambiguous linkage</li>
<li>The complete glycan structure itself</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac(??-?)Gal(??-?)[Fuc(??-?)]GlcNAc(??-?)Gal(??-?)GalNAc(b1-"</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gal(??-"</span>,</span>
<span>  <span class="st">"Fuc(??-?)GlcNAc(??-"</span>,</span>
<span>  <span class="va">glycan</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">count_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 1 1</span></span></code></pre></div>
<p><strong>The computational perspective:</strong> ğŸ–¥ï¸ Behind the scenes,
weâ€™re performing subgraph isomorphism matching. Glycans and motifs are
represented as mathematical graphs, and weâ€™re searching for structural
embeddings.</p>
<p><strong>But there are two crucial distinctions from standard graph
theory:</strong></p>
<p><strong>First, directionality matters.</strong> â¬…ï¸â¡ï¸ The reducing end
(right side) and non-reducing end (left side) are biologically distinct.
Direction affects function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fuc(??-?)GlcNAc(??-"</span>, <span class="st">"GlcNAc(??-?)Fuc(??-"</span><span class="op">)</span></span>
<span><span class="fu">have_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE</span></span></code></pre></div>
<p><strong>Second, biological equivalence trumps mathematical
multiplicity.</strong> ğŸ”„ When multiple mathematically distinct matches
have identical biological meaning, we count them as one.</p>
<p>Consider this elegant example:</p>
<p><img src="img/branches_2.png"></p>
<p>Technically, this motif has two valid subgraph matches within the
glycan (â€œA-a, B-b, C-câ€ and â€œA-b, B-a, C-câ€). But from a biological
perspective, these matches are equivalentâ€”the specific assignment of
mannose residues doesnâ€™t matter. Therefore, <code><a href="../reference/count_motif.html">count_motif()</a></code>
reports exactly one match:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Man(??-?)[Man(??-?)]Man(??-?)GlcNAc(??-?)GlcNAc(??-"</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="st">"Man(??-?)[Man(??-?)]Man(??-"</span></span>
<span><span class="fu"><a href="../reference/count_motif.html">count_motif</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motif</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rule-2-linkage-flexibility">Rule 2: Linkage Flexibility ğŸ”—<a class="anchor" aria-label="anchor" href="#rule-2-linkage-flexibility"></a>
</h3>
<p>Linkage information in glycomics can be frustratingly incomplete. You
might encounter patterns like â€œ??-6â€, â€œa2-?â€, or complete unknowns. Our
matching philosophy is elegantly simple:</p>
<p><strong>The glycan cannot be more ambiguous than the
motif.</strong></p>
<p>This means a concrete linkage like â€œa2-6â€ in your glycan data will
match:</p>
<ul>
<li>â€œa2-6â€ (exact match) âœ…</li>
<li>â€œa2-?â€ (position-specific, anomer flexible) âœ…<br>
</li>
<li>â€œ??-6â€ (anomer-specific, position flexible) âœ…</li>
<li>â€œ??-?â€ (completely flexible wildcard) âœ…</li>
</ul>
<p>But an ambiguous linkage like â€œa2-?â€ will only match equally or more
flexible patterns in the motif.</p>
<p>Letâ€™s see this in practice:</p>
<p><img src="img/linkages.png"></p>
<p><strong>Pro tip about notation:</strong> ğŸ’¡ Following <a href="https://www.ncbi.nlm.nih.gov/glycans/snfg.html" class="external-link">SNFG</a>
conventions, we often abbreviate linkages by omitting the anomeric
carbon number. So â€œa1-6â€ becomes simply â€œa6â€ since the anomeric position
is typically known.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)[Fuc(a1-6)]GlcNAc(b1-"</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Fuc(a1-?)GlcNAc(b1-"</span>,  <span class="co"># Motif 1: anomer known, position flexible</span></span>
<span>  <span class="st">"Fuc(a1-6)GlcNAc(b1-"</span>,  <span class="co"># Motif 2: exact linkage match</span></span>
<span>  <span class="st">"Fuc(a1-3)GlcNAc(b1-"</span>   <span class="co"># Motif 3: wrong position specification</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">have_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rule-3-monosaccharide-resolution">Rule 3: Monosaccharide Resolution ğŸ”¬<a class="anchor" aria-label="anchor" href="#rule-3-monosaccharide-resolution"></a>
</h3>
<p>Mass spectrometry often provides incomplete monosaccharide
identification. You might know thereâ€™s a hexose present but not whether
itâ€™s glucose, galactose, or mannose.</p>
<p>We distinguish between two resolution levels:</p>
<ul>
<li>
<strong>Concrete monosaccharides</strong>: Structurally specific
(e.g., â€œGalâ€, â€œManâ€, â€œGlcâ€)</li>
<li>
<strong>Generic monosaccharides</strong>: Compositionally defined
(e.g., â€œHexâ€, â€œHexNAcâ€, â€œdHexâ€)</li>
</ul>
<p>The matching rule mirrors our linkage philosophy: <strong>The glycan
cannot be more ambiguous than the motif.</strong></p>
<p>Specifically:</p>
<ul>
<li>Concrete monosaccharides in glycans can match both concrete and
generic motifs âœ…</li>
<li>Generic monosaccharides in glycans can only match generic motifs
âœ…</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/have_motif.html">have_motifs</a></span><span class="op">(</span>glycans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hex(a1-"</span>, <span class="st">"Man(a1-"</span><span class="op">)</span>, motifs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hex(a1-"</span>, <span class="st">"Man(a1-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="st">"_glycan"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="st">"_motif"</span><span class="op">)</span></span>
<span><span class="va">mat</span></span>
<span><span class="co">#&gt;                Hex(a1-_motif Man(a1-_motif</span></span>
<span><span class="co">#&gt; Hex(a1-_glycan          TRUE         FALSE</span></span>
<span><span class="co">#&gt; Man(a1-_glycan          TRUE          TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rule-4-chemical-modifications">Rule 4: Chemical Modifications ğŸ§ª<a class="anchor" aria-label="anchor" href="#rule-4-chemical-modifications"></a>
</h3>
<p>Real glycans are often decorated with chemical
modificationsâ€”acetylation, sulfation, methylation, and more. These
substituents have two components: position (where theyâ€™re attached) and
identity (what they are).</p>
<p>For example, â€œNeu5Ac9Acâ€ represents N-acetylneuraminic acid with an
additional 9-O-acetyl group.</p>
<p>The matching rules are straightforward but powerful:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Identity matching</strong>: If the glycan has a substituent,
the motif must have the same type to match</li>
<li>
<strong>Position flexibility</strong>: The glycan cannot be more
ambiguous than the motif regarding position</li>
</ol>
<p><img src="img/substituents.png"></p>
<p>Letâ€™s see this in action:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Neu5Ac9Ac(a2-"</span>, <span class="st">"Neu5Ac?Ac(a2-"</span>, <span class="st">"Neu5Ac(a2-"</span><span class="op">)</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Neu5Ac9Ac(a2-"</span>, <span class="st">"Neu5Ac?Ac(a2-"</span>, <span class="st">"Neu5Ac(a2-"</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/have_motif.html">have_motifs</a></span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"glycan_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"motif_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">mat</span></span>
<span><span class="co">#&gt;          motif_1 motif_2 motif_3</span></span>
<span><span class="co">#&gt; glycan_1    TRUE    TRUE   FALSE</span></span>
<span><span class="co">#&gt; glycan_2   FALSE    TRUE   FALSE</span></span>
<span><span class="co">#&gt; glycan_3   FALSE   FALSE    TRUE</span></span></code></pre></div>
<p>The default behavior is to match the substituent strictly. This is
reasonable in most cases, because monosaccharides with different
substituents should be regarded as different. However, you can change
this behavior by setting <code>strict_sub = FALSE</code>. In this case,
the substituent is optional in the motif, so the glycan â€œNeu5Ac9Acâ€ can
match the motif â€œNeu5Acâ€.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="st">"Neu5Ac9Ac(a2-"</span>, <span class="st">"Neu5Ac(a2-"</span>, strict_sub <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rule-5-alignment-constraints">Rule 5: Alignment Constraints ğŸ“<a class="anchor" aria-label="anchor" href="#rule-5-alignment-constraints"></a>
</h3>
<p>Hereâ€™s where biology meets computation in fascinating ways! ğŸ¯ Some
motifs are only meaningful in specific structural contexts.</p>
<p>Consider the N-glycan coreâ€”itâ€™s biologically significant only when
positioned at the reducing end. Similarly, the Tn antigen (simply
GalNAc) should represent the entire O-glycan structure, not just any
GalNAc residue buried within a larger molecule.</p>
<p>Following <a href="https://glycomotif.glyomics.org/" class="external-link">GlycoMotif</a>
standards, we recognize four alignment types:</p>
<ul>
<li>
<strong>â€œsubstructureâ€</strong>: The motif can appear anywhere
within the glycan ğŸ”</li>
<li>
<strong>â€œcoreâ€</strong>: Must align with a connected subtree at the
reducing end ğŸŒ±<br>
</li>
<li>
<strong>â€œterminalâ€</strong>: Must align with a connected subtree at
non-reducing ends ğŸƒ</li>
<li>
<strong>â€œwholeâ€</strong>: Must match the entire glycan structure
ğŸŒ³</li>
</ul>
<p><img src="img/alignment.png"></p>
<p>Letâ€™s verify these behaviors computationally:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-6)Gal(a1-"</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-6)Gal(a1-"</span>,  <span class="co"># motif 1: complete structure</span></span>
<span>  <span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-"</span>,           <span class="co"># motif 2: terminal branch</span></span>
<span>           <span class="st">"Gal(a1-4)Gal(a1-6)Gal(a1-"</span>,  <span class="co"># motif 3: reducing-end subtree</span></span>
<span>           <span class="st">"Gal(a1-4)Gal(a1-"</span>            <span class="co"># motif 4: internal fragment</span></span>
<span><span class="op">)</span></span>
<span><span class="va">alignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"substructure"</span>, <span class="st">"whole"</span>, <span class="st">"core"</span>, <span class="st">"terminal"</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">alignments</span>, <span class="op">~</span> <span class="fu">have_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span>, alignment <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">alignments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"motif_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">mat</span></span>
<span><span class="co">#&gt;         substructure whole  core terminal</span></span>
<span><span class="co">#&gt; motif_1         TRUE  TRUE  TRUE     TRUE</span></span>
<span><span class="co">#&gt; motif_2         TRUE FALSE FALSE     TRUE</span></span>
<span><span class="co">#&gt; motif_3         TRUE FALSE  TRUE    FALSE</span></span>
<span><span class="co">#&gt; motif_4         TRUE FALSE FALSE    FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rule-6-reducing-end-anomers">Rule 6: Reducing End Anomers ğŸ”„<a class="anchor" aria-label="anchor" href="#rule-6-reducing-end-anomers"></a>
</h3>
<p>The reducing end of a glycanâ€”that special monosaccharide connected to
proteins or lipidsâ€”deserves special attention. Its anomeric
configuration can significantly impact biological function.</p>
<p>The matching behavior depends on motif alignment:</p>
<p><strong>When the motif aligns away from the reducing end:</strong>
The motifâ€™s â€œreducing endâ€ (really just its rightmost residue) is
matched against the corresponding internal linkage.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Gal(a1-3)GalNAc(b1-"</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gal(a1-"</span>, <span class="st">"Gal(b1-"</span><span class="op">)</span></span>
<span><span class="fu">have_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE</span></span></code></pre></div>
<p><strong>When the motif aligns at the reducing end:</strong> Direct
comparison with the glycanâ€™s actual reducing end anomer.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="st">"Gal(a1-3)GalNAc(b1-"</span></span>
<span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GalNAc(a1-"</span>, <span class="st">"GalNAc(b1-"</span><span class="op">)</span></span>
<span><span class="fu">have_motifs_simple</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE  TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-big-picture-why-this-complexity-matters">The Big Picture: Why This Complexity Matters ğŸŒŸ<a class="anchor" aria-label="anchor" href="#the-big-picture-why-this-complexity-matters"></a>
</h2>
<p>You might be wondering: â€œWhy all these intricate rules?â€ The answer
lies in the beautiful complexity of biological systems. ğŸ§¬</p>
<p>Unlike artificial pattern matching, biological recognition systems
are:</p>
<ul>
<li>
<strong>Context-sensitive</strong>: The same motif can have
different meanings in different locations</li>
<li>
<strong>Fault-tolerant</strong>: Partial information should still
yield meaningful results<br>
</li>
<li>
<strong>Hierarchically organized</strong>: Generic patterns can be
refined into specific ones</li>
<li>
<strong>Chemically aware</strong>: Modifications and substitutions
are integral to function</li>
</ul>
<p>By encoding these biological principles into our matching algorithms,
<code>glymotif</code> bridges the gap between computational analysis and
biological reality.</p>
<p>Whether youâ€™re analyzing clinical glycomics data, exploring
evolutionary relationships, or designing glycan-based therapeutics,
these sophisticated matching rules ensure your results are both
computationally sound and biologically meaningful.</p>
</div>
<div class="section level2">
<h2 id="ready-for-more">Ready for More? ğŸš€<a class="anchor" aria-label="anchor" href="#ready-for-more"></a>
</h2>
<p>This deep dive into motif matching rules provides the foundation for
understanding how <code>glymotif</code> works. Armed with this
knowledge, youâ€™re ready to tackle even the most complex glycan analysis
challenges!</p>
<p>For practical applications and real-world examples, head back to the
<a href="glymotif.html">Getting Started guide</a>. For detailed function
documentation, explore the reference manual.</p>
<p>Happy glycan hunting! ğŸ”âœ¨</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
