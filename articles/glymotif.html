<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with glymotif ‚Ä¢ glymotif</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with glymotif">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glycoverse/glymotif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started with glymotif</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/glycoverse/glymotif/blob/main/vignettes/glymotif.Rmd" class="external-link"><code>vignettes/glymotif.Rmd</code></a></small>
      <div class="d-none name"><code>glymotif.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-is-a-glycan-motif">What is a Glycan Motif? üß¨<a class="anchor" aria-label="anchor" href="#what-is-a-glycan-motif"></a>
</h2>
<p>Imagine you‚Äôre looking at a complex glycan structure‚Äîthose intricate
branched molecules that decorate your cells. Hidden within these
molecular architectures are recurring patterns called ‚Äúmotifs.‚Äù Think of
them as the molecular equivalent of architectural motifs: recognizable
design elements that appear across different buildings (or in this case,
different glycans).</p>
<p>A glycan motif is simply a substructure that appears in multiple
glycans. (Don‚Äôt confuse this with protein motifs‚Äîwe‚Äôre talking about
carbohydrates here! üç≠) Some famous examples include the N-glycan core,
Lewis X antigen, and the Tn antigen.</p>
</div>
<div class="section level2">
<h2 id="why-should-you-care">Why Should You Care? ü§î<a class="anchor" aria-label="anchor" href="#why-should-you-care"></a>
</h2>
<p>Here‚Äôs where it gets exciting: these motifs aren‚Äôt just
decorative‚Äîthey‚Äôre functional. They determine how cells interact, how
pathogens bind, and how your immune system recognizes friend from
foe.</p>
<p>This package, <code>glymotif</code>, is your computational microscope
üî¨ for advanced glycan motif analysis. It helps you answer two
fundamental questions:</p>
<ul>
<li><strong>Does this glycan contain a specific motif?</strong></li>
<li><strong>How many times does this motif appear?</strong></li>
</ul>
<p>The best part? ‚ú® Everything works with vectors of glycans, so you
can analyze hundreds or thousands at once.</p>
<p><strong>Important note:</strong> This package builds on the powerful
<a href="https://github.com/glycoverse/glyrepr" class="external-link">glyrepr</a> package. If
you haven‚Äôt used it before, we highly recommend checking out its <a href="https://glycoverse.github.io/glyrepr/articles/glyrepr.html" class="external-link">introduction</a>
first.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/" class="external-link">glyrepr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glymotif/">glymotif</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-quick-challenge">A Quick Challenge üß©<a class="anchor" aria-label="anchor" href="#a-quick-challenge"></a>
</h2>
<p>Let‚Äôs start with a visual puzzle. Can you tell if the glycan on the
left contains the motif on the right?</p>
<p><img src="img/intro_example.png"></p>
<p>If you said ‚Äúyes,‚Äù congratulations‚Äîyou have a keen eye! üëÄ But what
if I gave you 500 glycans and 20 motifs to check? That‚Äôs where
<code>glymotif</code> becomes indispensable.</p>
<p>Let‚Äôs see it in action using IUPAC-condensed notation (the standard
text format for glycans in the <code>glycoverse</code> ecosystem). If
this notation looks unfamiliar, don‚Äôt worry‚Äîcheck out <a href="https://glycoverse.github.io/glyrepr/articles/iupac.html" class="external-link">this
helpful guide</a> first.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Neu5Ac(a2-3)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-3)Gal(b1-3)GalNAc(b1-"</span>,</span>
<span>  <span class="st">"Neu5Ac(a2-?)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-"</span>,</span>
<span>  <span class="st">"Man(b1-4)GlcNAc(b1-4)[Fuc(a1-3)]GlcNAc(b1-"</span>,</span>
<span>  <span class="st">"Gal(b1-3)GalNAc(b1-"</span>,</span>
<span>  <span class="st">"Neu5Ac9Ac(a2-3)Gal(b1-4)GlcNAc(b1-"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac(a2-3)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-"</span></span>
<span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motif</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Pretty neat, right? üòé</p>
</div>
<div class="section level2">
<h2 id="your-toolkit-four-essential-functions">Your Toolkit: Four Essential Functions üõ†Ô∏è<a class="anchor" aria-label="anchor" href="#your-toolkit-four-essential-functions"></a>
</h2>
<p><code>glymotif</code> provides four core functions that work together
like a well-designed instrument panel:</p>
<ul>
<li>
<strong><code><a href="../reference/have_motif.html">have_motif()</a></code></strong>: Returns TRUE/FALSE for
each glycan‚Äîdoes it contain the motif?</li>
<li>
<strong><code><a href="../reference/count_motif.html">count_motif()</a></code></strong>: Returns numbers‚Äîhow
many times does the motif appear?</li>
<li>
<strong><code><a href="../reference/have_motif.html">have_motifs()</a></code></strong>: The plural
version‚Äîchecks multiple motifs at once, returns a matrix</li>
<li>
<strong><code><a href="../reference/count_motif.html">count_motifs()</a></code></strong>: Counts multiple motifs
simultaneously, returns a matrix</li>
</ul>
<div class="section level3">
<h3 id="why-the-plural-functions">Why the Plural Functions? ü§∑‚Äç‚ôÄÔ∏è<a class="anchor" aria-label="anchor" href="#why-the-plural-functions"></a>
</h3>
<p>You might wonder: ‚ÄúWhy not just use <code><a href="../reference/have_motif.html">have_motif()</a></code> in a
loop?‚Äù Great question! üí≠ There are two compelling reasons:</p>
<p><strong>1. Predictable output format</strong> üìä Just like the
<code>purrr</code> package has different <code>map</code> functions for
different return types, our functions guarantee consistent outputs. The
singular functions return vectors; the plural functions return matrices.
No surprises, no wrestling with data types.</p>
<p><strong>2. Optimized performance</strong> ‚ö° The plural functions are
specifically optimized for multiple motifs. They‚Äôre significantly faster
than looping or using <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code> because they avoid
redundant computations.</p>
</div>
<div class="section level3">
<h3 id="seeing-them-in-action">Seeing Them in Action<a class="anchor" aria-label="anchor" href="#seeing-them-in-action"></a>
</h3>
<p>Let‚Äôs define some motifs to work with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Neu5Ac(a2-3)Gal(b1-3)[Fuc(a1-6)]GlcNAc(b1-"</span>,</span>
<span>  <span class="st">"Fuc(a1-"</span>,</span>
<span>  <span class="st">"Gal(b1-3)GalNAc(b1-"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All functions follow the same pattern:</p>
<ul>
<li>
<strong>First argument:</strong> your glycans (as IUPAC strings or a
<code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> object)</li>
<li>
<strong>Second argument:</strong> your motif(s) (IUPAC strings, a
<code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> object, or predefined motif
names)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motif</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="../reference/have_motif.html">have_motifs</a></span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Removing names for cleaner display</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]</span></span>
<span><span class="co">#&gt; [1,]  TRUE  TRUE  TRUE</span></span>
<span><span class="co">#&gt; [2,] FALSE  TRUE FALSE</span></span>
<span><span class="co">#&gt; [3,] FALSE  TRUE FALSE</span></span>
<span><span class="co">#&gt; [4,] FALSE FALSE  TRUE</span></span>
<span><span class="co">#&gt; [5,] FALSE FALSE FALSE</span></span></code></pre></div>
<p><strong>Pro tip:</strong> üí° You don‚Äôt need to memorize complex IUPAC
strings! Use predefined motif names instead:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/all_motifs.html">all_motifs</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "Blood group H (type 2) - Lewis y" "i antigen"                       </span></span>
<span><span class="co">#&gt;  [3] "LacdiNAc"                         "GT2"                             </span></span>
<span><span class="co">#&gt;  [5] "Blood group B (type 1) - Lewis b" "LcGg4"                           </span></span>
<span><span class="co">#&gt;  [7] "Sialosyl paragloboside"           "Sialyl Lewis x"                  </span></span>
<span><span class="co">#&gt;  [9] "A antigen (type 3)"               "Type 1 LN2"</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="va">glycans</span>, <span class="st">"Type 2 LN2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p><strong>Caution:</strong> If you are using predefined motif names,
you should be aware that all of the built-in motifs have ‚Äúintact‚Äù
structure level. See the ‚ÄúHandling Structural Ambiguity‚Äù section below
for more details.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-art-and-science-of-motif-matching">The Art and Science of Motif Matching üé®üî¨<a class="anchor" aria-label="anchor" href="#the-art-and-science-of-motif-matching"></a>
</h2>
<p>Now we enter the fascinating complexity of motif recognition. You
might think: ‚ÄúIt‚Äôs just pattern matching, right?‚Äù Well, not quite.
ü§®</p>
<p>Real-world glycan data is beautifully messy:</p>
<ul>
<li>
<strong>Missing linkage information</strong>: Sometimes we only know
‚Äúthere‚Äôs a link‚Äù but not its exact type</li>
<li>
<strong>Generic monosaccharides</strong>: Mass spectrometry might
only tell us ‚ÄúHex‚Äù instead of ‚ÄúGlucose‚Äù</li>
<li>
<strong>Chemical modifications</strong>: Sulfation, acetylation, and
other decorations add complexity</li>
<li>
<strong>Alignment constraints</strong>: Some motifs only ‚Äúcount‚Äù
when they appear in specific locations</li>
</ul>
<p>Consider the Tn antigen‚Äîit‚Äôs just a single GalNAc residue. But it
shouldn‚Äôt match every GalNAc in a complex N-glycan, should it? Context
matters.</p>
<p>Similarly, an O-glycan core motif should only be recognized at the
reducing end, not buried in the middle of a structure.</p>
<p><code>glymotif</code> handles all these complexities through its
sophisticated matching engine. The algorithm considers structural
context, chemical modifications, and biological relevance to make
intelligent matching decisions.</p>
</div>
<div class="section level2">
<h2 id="handling-structural-ambiguity">Handling Structural Ambiguity ü§î<a class="anchor" aria-label="anchor" href="#handling-structural-ambiguity"></a>
</h2>
<p>Real-world glycan data often comes with structural ambiguity. Mass
spectrometry might only tell us ‚ÄúHexNAc‚Äù instead of ‚ÄúGlcNAc‚Äù, or linkage
analysis might yield ‚Äúa1-?‚Äù instead of ‚Äúa1-6‚Äù. These uncertainties are
common in experimental glycomics and glycoproteomics.</p>
<div class="section level3">
<h3 id="how-glymotif-handles-structural-ambiguity">How <code>glymotif</code> Handles Structural Ambiguity<a class="anchor" aria-label="anchor" href="#how-glymotif-handles-structural-ambiguity"></a>
</h3>
<p><code>glymotif</code> handles these ambiguities with a fundamental
principle: <strong>A glycan cannot be more ambiguous than the motif it‚Äôs
being matched against.</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ambiguous linkages won't match specific ones</span></span>
<span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="st">"Gal(??-?)GalNAc(??-"</span>, <span class="st">"Gal(a1-6)GalNAc(a1-"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co"># Generic monosaccharides won't match specific ones</span></span>
<span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="st">"Hex(a1-6)HexNAc(a1-"</span>, <span class="st">"Gal(a1-6)GalNAc(a1-"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>This behavior is <strong>intentional</strong>, not a bug. ‚ú® True
motif identification requires confidence: structural possibilities alone
aren‚Äôt sufficient evidence.</p>
</div>
<div class="section level3">
<h3 id="working-around-ambiguity">Working Around Ambiguity<a class="anchor" aria-label="anchor" href="#working-around-ambiguity"></a>
</h3>
<p>If you‚Äôre getting unexpected <code>FALSE</code> results with
<code><a href="../reference/have_motif.html">have_motif()</a></code> (especially when using built-in motifs with
ambiguous glycans), the first thing you should do is to check the
structure level of the glycan and the motif. You can use
<code><a href="https://glycoverse.github.io/glyrepr/reference/get_structure_level.html" class="external-link">glyrepr::get_structure_level()</a></code> to help you with this
task.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get_structure_level() expects a glycan structure vector</span></span>
<span><span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/get_structure_level.html" class="external-link">get_structure_level</a></span><span class="op">(</span><span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/as_glycan_structure.html" class="external-link">as_glycan_structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gal(??-?)GalNAc(??-"</span>, <span class="st">"Gal(a1-6)GalNAc(a1-"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "topological" "intact"</span></span></code></pre></div>
<p>here are two strategies:</p>
<p><strong>1. Ignore linkage information</strong> when linkages are
unreliable:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="st">"Gal(??-?)GalNAc(??-"</span>, <span class="st">"Gal(a1-6)GalNAc(a1-"</span>, ignore_linkages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p><strong>2. Convert motifs to generic forms</strong> to match the
generic monosaccharides of your data:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">glyparse</span><span class="fu">::</span><span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">auto_parse</a></span><span class="op">(</span><span class="st">"Gal(a1-6)GalNAc(a1-"</span><span class="op">)</span>  <span class="co"># First, create a `glycan_structure()`</span></span>
<span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu">glyrepr</span><span class="fu">::</span><span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/convert_to_generic.html" class="external-link">convert_to_generic</a></span><span class="op">(</span><span class="va">motif</span><span class="op">)</span>  <span class="co"># Then, convert to generic</span></span>
<span><span class="fu"><a href="../reference/have_motif.html">have_motif</a></span><span class="op">(</span><span class="st">"Hex(a1-6)HexNAc(a1-"</span>, <span class="va">motif</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>‚ö†Ô∏è <strong>Important:</strong> When using these workarounds,
interpret your results with appropriate caution. You‚Äôre trading
specificity for coverage.</p>
</div>
</div>
<div class="section level2">
<h2 id="dynamic-motif-detection">Dynamic Motif Detection<a class="anchor" aria-label="anchor" href="#dynamic-motif-detection"></a>
</h2>
<p>While matching against a database of known motifs is powerful,
sometimes you want to discover what motifs are actually present in your
specific dataset, even those not in the database. This is where dynamic
motif detection comes in.</p>
<p>Instead of asking ‚ÄúIs motif A here?‚Äù, we ask ‚ÄúWhat motifs are
here?‚Äù.</p>
<div class="section level3">
<h3 id="extract_motif">
<code>extract_motif()</code><a class="anchor" aria-label="anchor" href="#extract_motif"></a>
</h3>
<p><code><a href="../reference/extract_motif.html">extract_motif()</a></code> allows you to detect all motifs appears
in a set of glycans. Take a simple O-glycan for example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_motif.html">extract_motif</a></span><span class="op">(</span><span class="st">"Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[6]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [4] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [5] <span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [6] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)[<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)]<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; # Unique structures: 6</span></span></code></pre></div>
<p>This function works vectorizedly, and only a unique set of motifs
will be returned.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_motif.html">extract_motif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-"</span>,</span>
<span>  <span class="st">"Gal(b1-3)GalNAc(a1-"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[6]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [4] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [5] <span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [6] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)[<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)]<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; # Unique structures: 6</span></span></code></pre></div>
<p>As you can imagine, the number of possible dynamic motifs in a large
glycan can be very large. Therefore, <code><a href="../reference/extract_motif.html">extract_motif()</a></code> has a
<code>max_size</code> parameter restricting the size of motifs to be
extracted. By default, <code>max_size = 3</code>, this restricts the
motifs to be extracted to those with at most 3 monosaccharides.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_motif.html">extract_motif</a></span><span class="op">(</span><span class="st">"Glc(a1-2)Glc(a1-2)Glc(a1-2)Glc(a1-"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[3]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; # Unique structures: 3</span></span></code></pre></div>
<p>You can increase the <code>max_size</code> to extract larger
motifs.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_motif.html">extract_motif</a></span><span class="op">(</span><span class="st">"Glc(a1-2)Glc(a1-2)Glc(a1-2)Glc(a1-"</span>, max_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[4]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; [4] <span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-2</span>)<span style="color: #0087D7;">Glc</span>(<span style="color: #B2B2B2;">a1-</span></span></span>
<span><span class="co">#&gt; # Unique structures: 4</span></span></code></pre></div>
<p>However, increase it progressively with caution, as the computation
time can increase exponentially.</p>
</div>
<div class="section level3">
<h3 id="extract_branch_motif">
<code>extract_branch_motif()</code><a class="anchor" aria-label="anchor" href="#extract_branch_motif"></a>
</h3>
<p><code><a href="../reference/extract_motif.html">extract_motif()</a></code> works well with O-glycans, which are
very versatile and not very large. However, using it on N-glycans might
be less effective and less meaningful, as the core pattern of an
N-glycan is very restricted by the biosynthesis rules. The only
diversity comes from the antennae. Therefore, we provide
<code><a href="../reference/extract_branch_motif.html">extract_branch_motif()</a></code> to extract only the branching
motifs.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-2)Man(a1-3)[Gal(b1-4)GlcNAc(b1-2)Man(a1-6)]Man(b1-4)GlcNAc(a1-4)GlcNAc(b1-"</span>,</span>
<span>  <span class="st">"Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-2)Man(a1-3)[Neu5Ac(a2-6)Gal(b1-4)GlcNAc(b1-2)Man(a1-6)]Man(b1-4)GlcNAc(a1-4)GlcNAc(b1-"</span>,</span>
<span>  <span class="st">"Gal(b1-4)GlcNAc(b1-2)Man(a1-3)[GlcNAc(b1-2)Man(a1-6)]Man(b1-4)GlcNAc(a1-4)GlcNAc(b1-"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/extract_branch_motif.html">extract_branch_motif</a></span><span class="op">(</span><span class="va">glycans</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;glycan_structure[4]&gt;</span></span>
<span><span class="co">#&gt; [1] <span style="color: #AF5FAF;">Neu5Ac</span>(<span style="color: #B2B2B2;">a2-3</span>)<span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [2] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [3] <span style="color: #AF5FAF;">Neu5Ac</span>(<span style="color: #B2B2B2;">a2-6</span>)<span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; [4] <span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span></span>
<span><span class="co">#&gt; # Unique structures: 4</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="whats-next">What‚Äôs Next?<a class="anchor" aria-label="anchor" href="#whats-next"></a>
</h2>
<ul>
<li>Want to known all the details about motif matching rules? <a href="https://glycoverse.github.io/glymotif/articles/motif-matching.html">Here</a>
</li>
<li>Working with <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code>? <a href="https://glycoverse.github.io/glymotif/articles/with-exp.html">Here</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="standing-on-the-shoulders-of-giants">Standing on the Shoulders of Giants üèîÔ∏è<a class="anchor" aria-label="anchor" href="#standing-on-the-shoulders-of-giants"></a>
</h2>
<p>This work wouldn‚Äôt be possible without the inspiration and groundwork
laid by several excellent projects:</p>
<ul>
<li>
<a href="https://github.com/BojarLab/glycowork" class="external-link">glycowork</a>: A
comprehensive Python toolkit for glycan analysis üêç</li>
<li>
<a href="https://github.com/LewisLabUCSD/GlyCompare" class="external-link">GlyCompare</a>:
Advanced glycan comparison algorithms üî¨</li>
</ul>
<p>We‚Äôre proud to contribute to this growing ecosystem of computational
glycobiology tools! üå±</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
