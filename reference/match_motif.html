<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Match Motif(s) in Glycans — match_motif • glymotif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match Motif(s) in Glycans — match_motif"><meta name="description" content="These functions find all occurrences of the given motif(s) in the glycans.
Node-to-node mapping is returned for each match.
This function is NOT useful for most users if you are not interested in the concrete node mapping.
See have_motif() and count_motif() for more information about the matching rules.
match_motif() matches a single motif against multiple glycans
match_motifs() matches multiple motifs against multiple glycans


Different from have_motif() and count_motif(),
these functions return detailed match information.
More specifically, for each glycan-motif pair,
a integer vector is returned,
indicating the node mapping from the motif to the glycan.
For example, if the vector is c(2, 3, 6),
it means that the first node in the motif matches the 2nd node in the glycan,
the second node in the motif matches the 3rd node in the glycan,
and the third node in the motif matches the 6th node in the glycan.
Node indices are only meaningful for glyrepr::glycan_structure(),
so only glyrepr::glycan_structure() is supported for glycans and motifs."><meta property="og:description" content="These functions find all occurrences of the given motif(s) in the glycans.
Node-to-node mapping is returned for each match.
This function is NOT useful for most users if you are not interested in the concrete node mapping.
See have_motif() and count_motif() for more information about the matching rules.
match_motif() matches a single motif against multiple glycans
match_motifs() matches multiple motifs against multiple glycans


Different from have_motif() and count_motif(),
these functions return detailed match information.
More specifically, for each glycan-motif pair,
a integer vector is returned,
indicating the node mapping from the motif to the glycan.
For example, if the vector is c(2, 3, 6),
it means that the first node in the motif matches the 2nd node in the glycan,
the second node in the motif matches the 3rd node in the glycan,
and the third node in the motif matches the 6th node in the glycan.
Node indices are only meaningful for glyrepr::glycan_structure(),
so only glyrepr::glycan_structure() is supported for glycans and motifs."><meta property="og:image" content="https://glycoverse.github.io/glymotif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Match Motif(s) in Glycans</h1>

      <div class="d-none name"><code>match_motif.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions find all occurrences of the given <code>motif</code>(s) in the <code>glycans</code>.
Node-to-node mapping is returned for each match.
This function is NOT useful for most users if you are not interested in the concrete node mapping.
See <code><a href="have_motif.html">have_motif()</a></code> and <code><a href="count_motif.html">count_motif()</a></code> for more information about the matching rules.</p><ul><li><p><code>match_motif()</code> matches a single motif against multiple glycans</p></li>
<li><p><code>match_motifs()</code> matches multiple motifs against multiple glycans</p></li>
</ul><p>Different from <code><a href="have_motif.html">have_motif()</a></code> and <code><a href="count_motif.html">count_motif()</a></code>,
these functions return detailed match information.
More specifically, for each glycan-motif pair,
a integer vector is returned,
indicating the node mapping from the motif to the glycan.
For example, if the vector is <code>c(2, 3, 6)</code>,
it means that the first node in the motif matches the 2nd node in the glycan,
the second node in the motif matches the 3rd node in the glycan,
and the third node in the motif matches the 6th node in the glycan.</p>
<p>Node indices are only meaningful for <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code>,
so only <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> is supported for <code>glycans</code> and <code>motifs</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">match_motif</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motif</span>, alignment <span class="op">=</span> <span class="cn">NULL</span>, ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">match_motifs</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span>, alignments <span class="op">=</span> <span class="cn">NULL</span>, ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-glycans">glycans<a class="anchor" aria-label="anchor" href="#arg-glycans"></a></dt>
<dd><p>A <code>glyrepr_structure</code> object.</p></dd>


<dt id="arg-motif">motif<a class="anchor" aria-label="anchor" href="#arg-motif"></a></dt>
<dd><p>A <code>glyrepr_structure</code> object with length 1.</p></dd>


<dt id="arg-alignment">alignment<a class="anchor" aria-label="anchor" href="#arg-alignment"></a></dt>
<dd><p>A character string.
Possible values are "substructure", "core", "terminal" and "whole".
If not provided, the value will be decided based on the <code>motif</code> argument.
If <code>motif</code> is a motif name, the alignment in the database will be used.
Otherwise, "substructure" will be used.</p></dd>


<dt id="arg-ignore-linkages">ignore_linkages<a class="anchor" aria-label="anchor" href="#arg-ignore-linkages"></a></dt>
<dd><p>A logical value. If <code>TRUE</code>, linkages will be ignored in the comparison.</p></dd>


<dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>A <code>glyrepr_structure</code> object.</p></dd>


<dt id="arg-alignments">alignments<a class="anchor" aria-label="anchor" href="#arg-alignments"></a></dt>
<dd><p>A character vector specifying alignment types for each motif.
Can be a single value (applied to all motifs) or a vector of the same length as motifs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A nested list of integer vectors.</p><ul><li><p><code>match_motif()</code>: Two levels of nesting.
The outer list corresponds to glycans, and the inner list corresponds to matches.
Use <code>purrr::pluck(result, glycan_index, match_index)</code> to access the match information.
For example, <code>purrr::pluck(result, 1, 2)</code> means the 2nd match in the 1st glycan.</p></li>
<li><p><code>match_motifs()</code>: Three levels of nesting.
The outermost list corresponds to motifs, the middle list corresponds to glycans,
and the innermost list corresponds to matches.
Use <code>purrr::pluck(result, motif_index, glycan_index, match_index)</code> to access the match information.
For example, <code>purrr::pluck(result, 1, 2, 3)</code> means the 3rd match in the 2nd glycan for the 1st motif.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="vertex-and-linkage-indices">Vertex and Linkage Indices<a class="anchor" aria-label="anchor" href="#vertex-and-linkage-indices"></a></h2>
    <p>The indices of vertices and linkages in a glycan correspond directly to their
order in the IUPAC-condensed string, which is printed when you print a
<code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code>.
For example, for the glycan <code>Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc(b1-)</code>,
the vertices are "Man", "Man", "Man", "GlcNAc", "GlcNAc",
and the linkages are "a1-3", "a1-6", "b1-4", "b1-4".</p>
<p>Thus, matching the motif "Man(a1-3)Man(b1-4)" to this glycan yields <code>c(1, 3)</code>.
This indicates that the first motif vertex (the a1-3 Man) corresponds to
the first vertex in the glycan, and the second motif vertex (the b1-4 Man)
corresponds to the third vertex in the glycan.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="have_motif.html">have_motif()</a></code>, <code><a href="count_motif.html">count_motif()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyparse/" class="external-link">glyparse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/" class="external-link">glyrepr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/n_glycan_core.html" class="external-link">n_glycan_core</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;glycan_structure[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] <span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-3</span>)[<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">a1-6</span>)]<span style="color: #00AF5F;">Man</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-4</span>)<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Unique structures: 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's peek under the hood of the nodes in the glycan</span></span></span>
<span class="r-in"><span><span class="va">glycan_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/get_structure_graphs.html" class="external-link">get_structure_graphs</a></span><span class="op">(</span><span class="va">glycan</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">glycan_graph</span><span class="op">)</span><span class="op">$</span><span class="va">mono</span>  <span class="co"># 1, 2, 3, 4, 5</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Man"    "Man"    "Man"    "GlcNAc" "GlcNAc"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match a single motif against a single glycan</span></span></span>
<span class="r-in"><span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Man(a1-3)[Man(a1-6)]Man(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">match_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motif</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match multiple motifs against a single glycan</span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Man(a1-3)[Man(a1-6)]Man(b1-"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Man(a1-3)Man(b1-4)GlcNAc(b1-4)GlcNAc(?1-"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="va">motifs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">match_motifs</span><span class="op">(</span><span class="va">glycan</span>, <span class="va">motifs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]][[1]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]][[1]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 3 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

