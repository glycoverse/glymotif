<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Quantify motifs in an experiment — quantify_motifs • glymotif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantify motifs in an experiment — quantify_motifs"><meta name="description" content='This function quantifies motifs from glycomic or glycoproteomic profiles.
For glycomics data, it calculates the motif quantifications directly.
For glycoproteomics data, each glycosite is treated as a separate glycome,
and motif quantifications are calculated in a site-specific manner.
The function takes a glyexp::experiment() and returns a new glyexp::experiment()
with motif quantifications. Instead of containing the quantification of each glycan
on each glycosite in each sample, the new experiment contains the quantification
of each motif on each glycosite in each sample (for glycoproteomics data) or
the motif quantification in each sample (for glycomics data).
Due to the unified data structure of glyexp::experiment(),
the returned motif experiment can be passed to downstream glycoverse
functions like glystats::gly_ttest() for further statistical analysis.
Also, you can use as_tibble() to convert it to a "tidy" tibble for custom analysis.'><meta property="og:description" content='This function quantifies motifs from glycomic or glycoproteomic profiles.
For glycomics data, it calculates the motif quantifications directly.
For glycoproteomics data, each glycosite is treated as a separate glycome,
and motif quantifications are calculated in a site-specific manner.
The function takes a glyexp::experiment() and returns a new glyexp::experiment()
with motif quantifications. Instead of containing the quantification of each glycan
on each glycosite in each sample, the new experiment contains the quantification
of each motif on each glycosite in each sample (for glycoproteomics data) or
the motif quantification in each sample (for glycomics data).
Due to the unified data structure of glyexp::experiment(),
the returned motif experiment can be passed to downstream glycoverse
functions like glystats::gly_ttest() for further statistical analysis.
Also, you can use as_tibble() to convert it to a "tidy" tibble for custom analysis.'><meta property="og:image" content="https://glycoverse.github.io/glymotif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quantify motifs in an experiment</h1>

      <div class="d-none name"><code>quantify_motifs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function quantifies motifs from glycomic or glycoproteomic profiles.
For glycomics data, it calculates the motif quantifications directly.
For glycoproteomics data, each glycosite is treated as a separate glycome,
and motif quantifications are calculated in a site-specific manner.</p>
<p>The function takes a <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> and returns a new <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code>
with motif quantifications. Instead of containing the quantification of each glycan
on each glycosite in each sample, the new experiment contains the quantification
of each motif on each glycosite in each sample (for glycoproteomics data) or
the motif quantification in each sample (for glycomics data).</p>
<p>Due to the unified data structure of <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code>,
the returned motif experiment can be passed to downstream <code>glycoverse</code>
functions like <code>glystats::gly_ttest()</code> for further statistical analysis.
Also, you can use <code>as_tibble()</code> to convert it to a "tidy" tibble for custom analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quantify_motifs</span><span class="op">(</span><span class="va">exp</span>, <span class="va">motifs</span>, alignments <span class="op">=</span> <span class="cn">NULL</span>, ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-exp">exp<a class="anchor" aria-label="anchor" href="#arg-exp"></a></dt>
<dd><p>A <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object. Before using this function,
you should preprocess the data using the <code>glyclean</code> package.
For glycoproteomics data, the data should be aggregated to the
"gfs" (glycoforms with structures) level using <code><a href="https://glycoverse.github.io/glyclean/reference/aggregate.html" class="external-link">glyclean::aggregate()</a></code>.
Also, please make sure that the <code>glycan_structure</code> column is present in the <code>var_info</code> table,
as not all glycoproteomics identification softwares provide this information.
The column can be a <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vector,
or a character vector of glycan structure strings supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code>.</p>
<p>For glycoproteomics data, the <code>var_info</code> table must contain:</p><ul><li><p><code>protein</code>: protein ID</p></li>
<li><p><code>protein_site</code>: the glycosite position on the protein
The unique combination of <code>protein</code> and <code>protein_site</code> determines a glycosite.</p></li>
</ul></dd>


<dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>A character vector of motif names, glycan structure strings,
or a 'glyrepr_structure' object.
For glycan structure strings, all formats supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code> are accepted,
including IUPAC-condensed, WURCS, GlycoCT, and others.</p></dd>


<dt id="arg-alignments">alignments<a class="anchor" aria-label="anchor" href="#arg-alignments"></a></dt>
<dd><p>A character vector specifying alignment types for each motif.
Can be a single value (applied to all motifs) or a vector of the same length as motifs.</p></dd>


<dt id="arg-ignore-linkages">ignore_linkages<a class="anchor" aria-label="anchor" href="#arg-ignore-linkages"></a></dt>
<dd><p>A logical value. If <code>TRUE</code>, linkages will be ignored in the comparison.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A new <code><a href="https://glycoverse.github.io/glyexp/reference/experiment.html" class="external-link">glyexp::experiment()</a></code> object for motif quantifications.
The new experiment contains the following columns in the <code>var_info</code> table:</p><ul><li><p><code>variable</code>: variable ID</p></li>
<li><p><code>motif</code>: motif name</p></li>
</ul><p>For glycoproteomics data, with additional columns:</p><ul><li><p><code>protein</code>: protein ID</p></li>
<li><p><code>protein_site</code>: the glycosite position on the protein</p></li>
</ul><p>Other columns in the <code>var_info</code> table (e.g. <code>gene</code>) are retained if they have "many-to-one"
relationship with glycosites (unique combinations of <code>protein</code>, <code>protein_site</code>).
That is, each glycosite cannot have multiple values for these columns.
<code>gene</code> is a common example, as a glycosite can only be associate with one gene.
Descriptions about glycans are not such a column, as a glycosite can have multiple glycans,
thus having multiple descriptions.
Columns not having this relationship with glycosites will be dropped.
Don't worry if you cannot understand this logic,
as long as you know that this function will try its best to preserve useful information.</p>
<p><code>sample_info</code> and <code>meta_data</code> are not modified,
except that the <code>exp_type</code> field of <code>meta_data</code> is set to "traitomics" for glycomics data,
and "traitproteomics" for glycoproteomics data.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="count_motif.html">count_motifs()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

