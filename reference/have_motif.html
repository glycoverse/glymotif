<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check if the Glycans have the Given Motif(s) — have_motif • glymotif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check if the Glycans have the Given Motif(s) — have_motif"><meta name="description" content="These functions check if the given glycans have the given motif(s).
have_motif() checks a single motif against multiple glycans
have_motifs() checks multiple motifs against multiple glycans


Technically speaking, they perform subgraph isomorphism tests to
determine if the motif(s) are subgraphs of the glycans.
Monosaccharides, linkages, and substituents are all considered."><meta property="og:description" content="These functions check if the given glycans have the given motif(s).
have_motif() checks a single motif against multiple glycans
have_motifs() checks multiple motifs against multiple glycans


Technically speaking, they perform subgraph isomorphism tests to
determine if the motif(s) are subgraphs of the glycans.
Monosaccharides, linkages, and substituents are all considered."><meta property="og:image" content="https://glycoverse.github.io/glymotif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/n-glycans.html">N-Glycans</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check if the Glycans have the Given Motif(s)</h1>

      <div class="d-none name"><code>have_motif.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions check if the given <code>glycan</code>s have the given <code>motif</code>(s).</p><ul><li><p><code>have_motif()</code> checks a single motif against multiple glycans</p></li>
<li><p><code>have_motifs()</code> checks multiple motifs against multiple glycans</p></li>
</ul><p>Technically speaking, they perform subgraph isomorphism tests to
determine if the <code>motif</code>(s) are subgraphs of the <code>glycan</code>s.
Monosaccharides, linkages, and substituents are all considered.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motif</span>, alignment <span class="op">=</span> <span class="cn">NULL</span>, ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">have_motifs</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span>, alignments <span class="op">=</span> <span class="cn">NULL</span>, ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-glycans">glycans<a class="anchor" aria-label="anchor" href="#arg-glycans"></a></dt>
<dd><p>A 'glyrepr_structure' object, or a glycan structure string vector.
All formats supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code> are accepted,
including IUPAC-condensed, WURCS, GlycoCT, and others.</p></dd>


<dt id="arg-motif">motif<a class="anchor" aria-label="anchor" href="#arg-motif"></a></dt>
<dd><p>A 'glyrepr_structure' object, a glycan structure string,
or a known motif name (use <code><a href="all_motifs.html">all_motifs()</a></code> to see all available motifs).
For glycan structure strings, all formats supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code> are accepted,
including IUPAC-condensed, WURCS, GlycoCT, and others.</p></dd>


<dt id="arg-alignment">alignment<a class="anchor" aria-label="anchor" href="#arg-alignment"></a></dt>
<dd><p>A character string.
Possible values are "substructure", "core", "terminal" and "whole".
If not provided, the value will be decided based on the <code>motif</code> argument.
If <code>motif</code> is a motif name, the alignment in the database will be used.
Otherwise, "substructure" will be used.</p></dd>


<dt id="arg-ignore-linkages">ignore_linkages<a class="anchor" aria-label="anchor" href="#arg-ignore-linkages"></a></dt>
<dd><p>A logical value. If <code>TRUE</code>, linkages will be ignored in the comparison.</p></dd>


<dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>A character vector of motif names, glycan structure strings,
or a 'glyrepr_structure' object.
For glycan structure strings, all formats supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code> are accepted,
including IUPAC-condensed, WURCS, GlycoCT, and others.</p></dd>


<dt id="arg-alignments">alignments<a class="anchor" aria-label="anchor" href="#arg-alignments"></a></dt>
<dd><p>A character vector specifying alignment types for each motif.
Can be a single value (applied to all motifs) or a vector of the same length as motifs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>have_motif()</code>: A logical vector indicating if each <code>glycan</code> has the <code>motif</code>.</p></li>
<li><p><code>have_motifs()</code>: A logical matrix where rows correspond to glycans and columns correspond to motifs.
Row names contain glycan identifiers and column names contain motif identifiers.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="about-names">About Names<a class="anchor" aria-label="anchor" href="#about-names"></a></h2>
    <p><code>have_motif()</code> and <code><a href="count_motif.html">count_motif()</a></code> return a vector with no names.
It is easy to trace the names back to the original glycans.</p>
<p><code>have_motifs()</code> and <code><a href="count_motif.html">count_motifs()</a></code> return a matrix with both row and column names.
The row names are the glycan names, and the column names are the motif names.
The names are decided according to the following rules:</p><ol><li><p>If <code>glycans</code> or <code>motifs</code> is a <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> object,
the names are the IUPAC-condensed structure strings.
(Sadly due to the constrains of the <code>vctrs</code> package <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> is built on,
a <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vector cannot have names.)</p></li>
<li><p>If <code>glycans</code> or <code>motifs</code> is a character vector, either IUPAC-condensed structure strings or
motif names, it will use the names of the character vector if exists,
otherwise use the character vector itself as the names.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="monosaccharide-type">Monosaccharide type<a class="anchor" aria-label="anchor" href="#monosaccharide-type"></a></h2>
    <p>They can have different monosaccharide types
("concrete" or "generic", see <code><a href="https://glycoverse.github.io/glyrepr/reference/get_mono_type.html" class="external-link">glyrepr::get_mono_type()</a></code>).
The matching rules are:</p><ul><li><p>When the motif is "generic", glycans are converted to "generic" type for comparison,
allowing both concrete and generic glycans to match generic motifs.</p></li>
<li><p>When the motif is "concrete", glycans are used as-is, so only concrete glycans
with matching monosaccharide names will match, while generic glycans will not match.</p></li>
</ul><p>Examples:</p><ul><li><p><code>Man</code> (concrete glycan) vs <code>Hex</code> (generic motif) → TRUE (Man converted to Hex for comparison)</p></li>
<li><p><code>Hex</code> (generic glycan) vs <code>Man</code> (concrete motif) → FALSE (names don't match)</p></li>
<li><p><code>Man</code> (concrete glycan) vs <code>Man</code> (concrete motif) → TRUE (exact match)</p></li>
<li><p><code>Hex</code> (generic glycan) vs <code>Hex</code> (generic motif) → TRUE (exact match)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="linkages">Linkages<a class="anchor" aria-label="anchor" href="#linkages"></a></h2>
    <p>Obscure linkages (e.g. "??-?") are allowed in the <code>motif</code> graph
(see <code><a href="https://glycoverse.github.io/glyrepr/reference/possible_linkages.html" class="external-link">glyrepr::possible_linkages()</a></code>).
"?" in a motif graph means "anything could be OK",
so it will match any linkage in the <code>glycan</code> graph.
However, "?" in a <code>glycan</code> graph will only match "?" in the <code>motif</code> graph.
You can set <code>ignore_linkages = TRUE</code> to ignore linkages in the comparison.</p>
<p>Some examples:</p><ul><li><p>"b1-?" in motif will match "b1-4" in glycan.</p></li>
<li><p>"b1-?" in motif will match "b1-?" in glycan.</p></li>
<li><p>"b1-4" in motif will NOT match "b1-?" in glycan.</p></li>
<li><p>"a1-?" in motif will NOT match "b1-4" in glycan.</p></li>
<li><p>"a1-?" in motif will NOT match "a?-4" in glycan.</p></li>
</ul><p>Both motifs and glycans can have a "half-linkage" at the reducing end,
e.g. "GlcNAc(b1-".
The half linkage in the motif will be matched to any linkage in the glycan,
or the half linkage of the glycan.
e.g. Glycan "GlcNAc(b1-4)Gal(a1-" will have both "GlcNAc(b1-" and "Gal(a1-" motifs.</p>
    </div>
    <div class="section level2">
    <h2 id="alignment">Alignment<a class="anchor" aria-label="anchor" href="#alignment"></a></h2>
    <p>According to the <a href="https://glycomotif.glyomics.org" class="external-link">GlycoMotif</a> database,
a motif can be classified into four alignment types:</p><ul><li><p>"substructure": The motif can be anywhere in the glycan. This is the default.
See <a href="https://glycomotif.glyomics.org/glycomotif/Substructure_Alignment" class="external-link">substructure</a>
for details.</p></li>
<li><p>"core": The motif must align with at least one connected substructure
(subtree) at the reducing end of the glycan.
See <a href="https://glycomotif.glyomics.org/glycomotif/Glycan_Core_Alignment" class="external-link">glycan core</a>
for details.</p></li>
<li><p>"terminal": The motif must align with at least one connected substructure
(subtree) at the nonreducing end of the glycan.
See <a href="https://glycomotif.glyomics.org/glycomotif/Nonreducing-End_Alignment" class="external-link">nonreducing end</a>
for details.</p></li>
<li><p>"whole": The motif must align with the entire glycan.
See <a href="https://glycomotif.glyomics.org/glycomotif/Whole-Glycan_Alignment" class="external-link">whole-glycan</a>
for details.</p></li>
</ul><p>When using known motifs in the GlycoMotif GlyGen Collection,
the best practice is to not provide the <code>alignment</code> argument,
and let the function decide the alignment based on the motif name.
However, it is still possible to override the default alignments.
In this case, the user-provided alignments will be used,
but a warning will be issued.</p>
    </div>
    <div class="section level2">
    <h2 id="substituents">Substituents<a class="anchor" aria-label="anchor" href="#substituents"></a></h2>
    <p>Substituents (e.g. "Ac", "SO3") are matched in strict mode.
Both single and multiple substituents are supported:</p><ul><li><p>Single substituents: "Neu5Ac-9Ac" will only match "Neu5Ac-9Ac" but not "Neu5Ac"</p></li>
<li><p>Multiple substituents: "Glc3Me6S" (has both 3Me and 6S) will only match motifs
that contain both substituents, e.g., "Glc3Me6S", "Glc?Me6S", "Glc3Me?S"</p></li>
<li><p>"Glc3Me6S" will NOT match "Glc3Me" (missing 6S) or "Glc" (missing both)</p></li>
</ul><p>For multiple substituents, they are internally stored as comma-separated values
(e.g. "3Me,6S") and matched individually. Each substituent in the motif must
have a corresponding match in the glycan, and vice versa.</p>
<p>Obscure linkages in motif substituents will match any linkage in glycan substituents:</p><ul><li><p>Motif "Neu5Ac-?Ac" will match "Neu5Ac-9Ac" in the glycan</p></li>
<li><p>Motif "Glc?Me6S" will match "Glc3Me6S" in the glycan (? matches 3)</p></li>
<li><p>Motif "Glc3Me?S" will match "Glc3Me6S" in the glycan (? matches 6)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a></h2>
    <p>Under the hood, the function uses <code><a href="https://r.igraph.org/reference/subgraph_isomorphisms.html" class="external-link">igraph::graph.get.subisomorphisms.vf2()</a></code>
to get all possible subgraph isomorphisms between <code>glycan</code> and <code>motif</code>.
<code>color</code> vertex attributes are added to the graphs to distinguish monosaccharides.
For all possible matches, the function checks the following:</p><ul><li><p>Alignment: using <code>alignment_check()</code></p></li>
<li><p>Substituents: using <code>substituent_check()</code></p></li>
<li><p>Linkages: using <code>linkage_check()</code></p></li>
<li><p>Anomer: using <code>anomer_check()</code>
The function returns <code>TRUE</code> if any of the matches pass all checks.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="count_motif.html">count_motif()</a></code>, <code><a href="count_motif.html">count_motifs()</a></code>, <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyparse/" class="external-link">glyparse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyrepr/" class="external-link">glyrepr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">glycan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/n_glycan_core.html" class="external-link">o_glycan_core_2</a></span><span class="op">(</span>mono_type <span class="op">=</span> <span class="st">"concrete"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;glycan_structure[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] <span style="color: #FFD700;">Gal</span>(<span style="color: #B2B2B2;">b1-3</span>)[<span style="color: #0087D7;">GlcNAc</span>(<span style="color: #B2B2B2;">b1-6</span>)]<span style="color: #FFD700;">GalNAc</span>(<span style="color: #B2B2B2;">a1-</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # Unique structures: 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The glycan has the motif "Gal(b1-3)GalNAc(b1-"</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="st">"Gal(b1-3)GalNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But not "Gal(b1-4)GalNAc(b1-" (wrong linkage)</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="st">"Gal(b1-4)GalNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set `ignore_linkages` to `TRUE` to ignore linkages</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="st">"Gal(b1-4)GalNAc(b1-"</span>, ignore_linkages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Different monosaccharide types are allowed</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="st">"Hex(b1-3)HexNAc(?1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obscure linkages in the `motif` graph are allowed</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan</span>, <span class="st">"Gal(b1-?)GalNAc(?1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># However, obscure linkages in `glycan` will only match "?" in the `motif` graph</span></span></span>
<span class="r-in"><span><span class="va">glycan_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Gal(b1-?)[GlcNAc(b1-6)]GalNAc(?1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_2</span>, <span class="st">"Gal(b1-3)GalNAc(?1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_2</span>, <span class="st">"Gal(b1-?)GalNAc(?1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The anomer of the motif will be matched to linkages in the glycan</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_2</span>, <span class="st">"GlcNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alignment types</span></span></span>
<span class="r-in"><span><span class="co"># The default type is "substructure", which means the motif can be anywhere in the glycan.</span></span></span>
<span class="r-in"><span><span class="co"># Other options include "core", "terminal" and "whole".</span></span></span>
<span class="r-in"><span><span class="va">glycan_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-6)Gal(a1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-6)Gal(a1-"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Gal(a1-3)Gal(a1-4)Gal(a1-"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"Gal(a1-4)Gal(a1-6)Gal(a1-"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"Gal(a1-4)Gal(a1-"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">motifs</span>, <span class="op">~</span> <span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_3</span>, <span class="va">.x</span>, alignment <span class="op">=</span> <span class="st">"whole"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE FALSE FALSE FALSE</span>
<span class="r-in"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">motifs</span>, <span class="op">~</span> <span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_3</span>, <span class="va">.x</span>, alignment <span class="op">=</span> <span class="st">"core"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE FALSE  TRUE FALSE</span>
<span class="r-in"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">motifs</span>, <span class="op">~</span> <span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_3</span>, <span class="va">.x</span>, alignment <span class="op">=</span> <span class="st">"terminal"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE  TRUE FALSE FALSE</span>
<span class="r-in"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">motifs</span>, <span class="op">~</span> <span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_3</span>, <span class="va">.x</span>, alignment <span class="op">=</span> <span class="st">"substructure"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE TRUE TRUE TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Substituents</span></span></span>
<span class="r-in"><span><span class="va">glycan_4</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac9Ac(a2-3)Gal(b1-4)GlcNAc(b1-"</span></span></span>
<span class="r-in"><span><span class="va">glycan_5</span> <span class="op">&lt;-</span> <span class="st">"Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_4</span>, <span class="va">glycan_5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_5</span>, <span class="va">glycan_4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_4</span>, <span class="va">glycan_4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_5</span>, <span class="va">glycan_5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple substituents</span></span></span>
<span class="r-in"><span><span class="va">glycan_6</span> <span class="op">&lt;-</span> <span class="st">"Glc3Me6S(a1-"</span>  <span class="co"># has both 3Me and 6S substituents</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_6</span>, <span class="st">"Glc3Me6S(a1-"</span><span class="op">)</span>  <span class="co"># TRUE: exact match</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_6</span>, <span class="st">"Glc?Me6S(a1-"</span><span class="op">)</span>  <span class="co"># TRUE: obscure linkage ?Me matches 3Me</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_6</span>, <span class="st">"Glc3Me?S(a1-"</span><span class="op">)</span>  <span class="co"># TRUE: obscure linkage ?S matches 6S</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_6</span>, <span class="st">"Glc3Me(a1-"</span><span class="op">)</span>    <span class="co"># FALSE: missing 6S substituent</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycan_6</span>, <span class="st">"Glc(a1-"</span><span class="op">)</span>       <span class="co"># FALSE: missing all substituents</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vectorization with single motif</span></span></span>
<span class="r-in"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">glycan</span>, <span class="va">glycan_2</span>, <span class="va">glycan_3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">motif</span> <span class="op">&lt;-</span> <span class="st">"Gal(b1-3)GalNAc(b1-"</span></span></span>
<span class="r-in"><span><span class="fu">have_motif</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motif</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE FALSE FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple motifs with have_motifs()</span></span></span>
<span class="r-in"><span><span class="va">glycan1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/n_glycan_core.html" class="external-link">o_glycan_core_2</a></span><span class="op">(</span>mono_type <span class="op">=</span> <span class="st">"concrete"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glycan2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Gal(b1-?)[GlcNAc(b1-6)]GalNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">glycan1</span>, <span class="va">glycan2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gal(b1-3)GalNAc(b1-"</span>, <span class="st">"Gal(b1-4)GalNAc(b1-"</span>, <span class="st">"GlcNAc(b1-6)GalNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">have_motifs</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   Gal(b1-3)GalNAc(b1- Gal(b1-4)GalNAc(b1-</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-               FALSE               FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GlcNAc(b1-6)[Gal(b1-?)]GalNAc(b1-               FALSE               FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   GlcNAc(b1-6)GalNAc(b1-</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-                  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GlcNAc(b1-6)[Gal(b1-?)]GalNAc(b1-                   TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can assign each motif a name</span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  motif1 <span class="op">=</span> <span class="st">"Gal(b1-3)GalNAc(b1-"</span>, </span></span>
<span class="r-in"><span>  motif2 <span class="op">=</span> <span class="st">"Gal(b1-4)GalNAc(b1-"</span>, </span></span>
<span class="r-in"><span>  motif3 <span class="op">=</span> <span class="st">"GlcNAc(b1-6)GalNAc(b1-"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">have_motifs</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   motif1 motif2 motif3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gal(b1-3)[GlcNAc(b1-6)]GalNAc(a1-  FALSE  FALSE  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GlcNAc(b1-6)[Gal(b1-?)]GalNAc(b1-  FALSE  FALSE   TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

