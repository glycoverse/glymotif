<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Count How Many Times Glycans have the Given Motif(s) — count_motif • glymotif</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Count How Many Times Glycans have the Given Motif(s) — count_motif"><meta name="description" content="These functions are closely related to have_motif().
However, instead of returning logical values, they return the number of times
the glycans have the motif(s).
count_motif() counts a single motif in multiple glycans
count_motifs() counts multiple motifs in multiple glycans

"><meta property="og:description" content="These functions are closely related to have_motif().
However, instead of returning logical values, they return the number of times
the glycans have the motif(s).
count_motif() counts a single motif in multiple glycans
count_motifs() counts multiple motifs in multiple glycans

"><meta property="og:image" content="https://glycoverse.github.io/glymotif/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glymotif</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glymotif.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/motif-matching.html">The Science Behind Motif Matching</a></li>
    <li><a class="dropdown-item" href="../articles/with-exp.html">Working with glyexp</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glycoverse/glymotif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Count How Many Times Glycans have the Given Motif(s)</h1>
      <small class="dont-index">Source: <a href="https://github.com/glycoverse/glymotif/blob/main/R/count-motif.R" class="external-link"><code>R/count-motif.R</code></a></small>
      <div class="d-none name"><code>count_motif.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions are closely related to <code><a href="have_motif.html">have_motif()</a></code>.
However, instead of returning logical values, they return the number of times
the <code>glycans</code> have the <code>motif</code>(s).</p><ul><li><p><code>count_motif()</code> counts a single motif in multiple glycans</p></li>
<li><p><code>count_motifs()</code> counts multiple motifs in multiple glycans</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">count_motif</span><span class="op">(</span></span>
<span>  <span class="va">glycans</span>,</span>
<span>  <span class="va">motif</span>,</span>
<span>  alignment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strict_sub <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">count_motifs</span><span class="op">(</span></span>
<span>  <span class="va">glycans</span>,</span>
<span>  <span class="va">motifs</span>,</span>
<span>  alignments <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ignore_linkages <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  strict_sub <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-glycans">glycans<a class="anchor" aria-label="anchor" href="#arg-glycans"></a></dt>
<dd><p>One of:</p><ul><li><p>A <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vector.</p></li>
<li><p>A glycan structure string vector. All formats supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code> are accepted,
including IUPAC-condensed, WURCS, GlycoCT, and others.</p></li>
</ul></dd>


<dt id="arg-motif">motif<a class="anchor" aria-label="anchor" href="#arg-motif"></a></dt>
<dd><p>One of:</p><ul><li><p>A <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> scalar.</p></li>
<li><p>A glycan structure string, supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code>.</p></li>
<li><p>A known motif name (use <code><a href="all_motifs.html">all_motifs()</a></code> to see all available motifs).</p></li>
</ul></dd>


<dt id="arg-alignment">alignment<a class="anchor" aria-label="anchor" href="#arg-alignment"></a></dt>
<dd><p>A character string.
Possible values are "substructure", "core", "terminal", "whole", and "exact".
If not provided, the value will be decided based on the <code>motif</code> argument.
If <code>motif</code> is a motif name, the alignment in the database will be used.
Otherwise, "substructure" will be used.</p></dd>


<dt id="arg-ignore-linkages">ignore_linkages<a class="anchor" aria-label="anchor" href="#arg-ignore-linkages"></a></dt>
<dd><p>A logical value. If <code>TRUE</code>, linkages will be ignored in the comparison.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-strict-sub">strict_sub<a class="anchor" aria-label="anchor" href="#arg-strict-sub"></a></dt>
<dd><p>A logical value. If <code>TRUE</code> (default), substituents will be matched in strict mode,
which means if the glycan has a substituent in some residue,
the motif must have the same substituent to be matched.</p></dd>


<dt id="arg-motifs">motifs<a class="anchor" aria-label="anchor" href="#arg-motifs"></a></dt>
<dd><p>One of:</p><ul><li><p>A <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vector.</p></li>
<li><p>A glycan structure string vector, supported by <code><a href="https://glycoverse.github.io/glyparse/reference/auto_parse.html" class="external-link">glyparse::auto_parse()</a></code>.</p></li>
<li><p>A character vector of motif names (use <code><a href="all_motifs.html">all_motifs()</a></code> to see all available motifs).</p></li>
</ul></dd>


<dt id="arg-alignments">alignments<a class="anchor" aria-label="anchor" href="#arg-alignments"></a></dt>
<dd><p>A character vector specifying alignment types for each motif.
Can be a single value (applied to all motifs) or a vector of the same length as motifs.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>count_motif()</code>: An integer vector indicating how many times each <code>glycan</code> has the <code>motif</code>.</p></li>
<li><p><code>count_motifs()</code>: An integer matrix where rows correspond to glycans and columns correspond to motifs.
Row names contain glycan identifiers and column names contain motif identifiers.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function actually perform v2f algorithm to get all possible matches
between <code>glycans</code> and <code>motif</code>.
However, the result is not necessarily the number of matches.</p>
<p>Think about the following example:</p><ul><li><p>glycan: <code>Gal(b1-?)[Gal(b1-?)]GlcNAc(b1-4)GlcNAc(b1-</code></p></li>
<li><p>motif: <code>Gal(b1-?)[Gal(b1-?)]GlcNAc(b1-</code></p></li>
</ul><p>To draw the glycan out:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Gal <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   \ b1<span class="sc">-</span>? b1<span class="dv">-4</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    GlcNAc <span class="sc">--</span> GlcNAc b1<span class="sc">-</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="er">/</span> b1<span class="sc">-</span>?</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>Gal <span class="dv">2</span></span></code></pre><p></p></div>
<p>To draw the motif out:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Gal <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   \ b1<span class="sc">-</span>?</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    GlcNAc b1<span class="sc">-</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="er">/</span> b1<span class="sc">-</span>?</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>Gal <span class="dv">2</span></span></code></pre><p></p></div>
<p>To differentiate the galactoses, we number them as "Gal 1" and "Gal 2"
in both the glycan and the motif.
The v2f subisomorphic algorithm will return two matches:</p><ul><li><p>Gal 1 in the glycan matches Gal 1 in the motif, and Gal 2 matches Gal 2.</p></li>
<li><p>Gal 1 in the glycan matches Gal 2 in the motif, and Gal 2 matches Gal 1.</p></li>
</ul><p>However, from a biological perspective, the two matches are the same.
This function will take care of this, and return the "unique" number of matches.</p>
<p>For other details about the handling of monosaccharide, linkages, alignment,
substituents, and implementation, see <code><a href="have_motif.html">have_motif()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="about-names">About Names<a class="anchor" aria-label="anchor" href="#about-names"></a></h2>
    <p><code><a href="have_motif.html">have_motif()</a></code> and <code>count_motif()</code> return a vector with no names.
It is easy to trace the names back to the original glycans.</p>
<p><code><a href="have_motif.html">have_motifs()</a></code> and <code>count_motifs()</code> return a matrix with both row and column names.
The row names are the glycan names, and the column names are the motif names.
The names are decided according to the following rules:</p><ol><li><p>If <code>glycans</code> or <code>motifs</code> is a <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> object,
the names are the IUPAC-condensed structure strings.
(Sadly due to the constrains of the <code>vctrs</code> package <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> is built on,
a <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code> vector cannot have names.)</p></li>
<li><p>If <code>glycans</code> or <code>motifs</code> is a character vector, either IUPAC-condensed structure strings or
motif names, it will use the names of the character vector if exists,
otherwise use the character vector itself as the names.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="have_motif.html">have_motif()</a></code>, <code><a href="have_motif.html">have_motifs()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyparse/" class="external-link">glyparse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span><span class="st">"Gal(b1-3)Gal(b1-3)GalNAc(b1-"</span>, <span class="st">"Gal(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Man(b1-?)[Man(b1-?)]GalNAc(b1-4)GlcNAc(b1-"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Man(b1-?)[Man(b1-?)]GalNAc(b1-"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span><span class="st">"Gal(b1-3)Gal(b1-"</span>, <span class="st">"Man(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Vectorized usage with single motif</span></span></span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gal(b1-3)Gal(b1-3)GalNAc(b1-"</span>, <span class="st">"Gal(b1-3)GalNAc(b1-"</span><span class="op">)</span>, <span class="st">"Gal(b1-"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple motifs with count_motifs()</span></span></span>
<span class="r-in"><span><span class="va">glycan1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Gal(b1-3)Gal(b1-3)GalNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glycan2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glycoverse.github.io/glyparse/reference/parse_iupac_condensed.html" class="external-link">parse_iupac_condensed</a></span><span class="op">(</span><span class="st">"Man(b1-?)[Man(b1-?)]GalNAc(b1-4)GlcNAc(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glycans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">glycan1</span>, <span class="va">glycan2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">motifs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gal(b1-3)GalNAc(b1-"</span>, <span class="st">"Gal(b1-"</span>, <span class="st">"Man(b1-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">count_motifs</span><span class="op">(</span><span class="va">glycans</span>, <span class="va">motifs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                            [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gal(b1-3)Gal(b1-3)GalNAc(b1-                  1    2    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Man(b1-?)[Man(b1-?)]GalNAc(b1-4)GlcNAc(b1-    0    0    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Monosaccharide type matching examples</span></span></span>
<span class="r-in"><span><span class="co"># Concrete glycan vs generic motif: matches (glycan converted to generic)</span></span></span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span><span class="st">"Man(?1-"</span>, <span class="st">"Hex(?1-"</span><span class="op">)</span> <span class="co"># Returns 1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generic glycan vs concrete motif: doesn't match</span></span></span>
<span class="r-in"><span><span class="fu">count_motif</span><span class="op">(</span><span class="st">"Hex(?1-"</span>, <span class="st">"Man(?1-"</span><span class="op">)</span> <span class="co"># Returns 0</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

